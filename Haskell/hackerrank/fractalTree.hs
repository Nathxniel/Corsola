-- Hackerrank: Fractal Tree

main :: IO ()
main
  = do
      x <- readLn :: IO Int
      mapIO putStrLn $  drawFractal startTree x

mapIO :: (a -> IO ()) -> [a] -> IO ()
mapIO _ []
  = return ()
mapIO f (x:xs)
  = do
      f x
      mapIO f xs

drawFractal :: [String] -> Int -> [String]
drawFractal iter0 n
  = glueFractal first second n
  where
    first 
      = take (div (length iter0) 2) iter0
    second
      = drop (div (length iter0) 2) iter0
    glueFractal :: [String] -> [String] -> Int -> [String]
    glueFractal top bottom 1
      = top ++ bottom
    glueFractal top bottom x
      = pad $ calcTop bottom ++ bottom

--glue :: [String] -> [String] -> [String]
--glue xs ys
--  = glue' (reverse xs) ys
--  where
--    glue' [] acc
--      = acc
--    glue' (f:fs) acc
--      = glue' fs (f:acc)

pad :: [String] -> [String]
pad xs
  | length xs == 63 = xs
  | otherwise       = pad $ ((take 100 . repeat) '_') : xs


calcTop :: [String] -> [String]
calcTop xs
  = drop (div (length xs) 2) xs

startTree :: [String]
startTree
  = ["____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "____________________________________________________________________________________________________",
     "_________________________________1_______________________________1__________________________________",
     "__________________________________1_____________________________1___________________________________",
     "___________________________________1___________________________1____________________________________",
     "____________________________________1_________________________1_____________________________________",
     "_____________________________________1_______________________1______________________________________",
     "______________________________________1_____________________1_______________________________________",
     "_______________________________________1___________________1________________________________________",
     "________________________________________1_________________1_________________________________________",
     "_________________________________________1_______________1__________________________________________",
     "__________________________________________1_____________1___________________________________________",
     "___________________________________________1___________1____________________________________________",
     "____________________________________________1_________1_____________________________________________",
     "_____________________________________________1_______1______________________________________________",
     "______________________________________________1_____1_______________________________________________",
     "_______________________________________________1___1________________________________________________",
     "________________________________________________1_1_________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________",
     "_________________________________________________1__________________________________________________"]
